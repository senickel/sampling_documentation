<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Geographic sampling" />
<meta property="og:type" content="book" />



<meta name="github-repo" content="senickel/geosampling_book" />

<meta name="author" content="Sebastian Nickel" />

<meta name="date" content="2018-10-04" />


<meta name="description" content="Geographic sampling">

<title>Geographic sampling</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/jquery-1.12.4/jquery.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Global") elem.value = "Show Global";
    else elem.value = "Hide Global";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Global" id="myButton1" style="position: absolute; top: 10%; right: 2%; z-index: 200"></input>')

</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>


<link rel="stylesheet" href="my_tufte.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#prerequisites">Prerequisites</a><ul>
<li><a href="index.html#study-area"><span class="toc-section-number">0.1</span> Study Area</a></li>
<li><a href="index.html#data"><span class="toc-section-number">0.2</span> Data</a></li>
<li><a href="index.html#geosampling-package"><span class="toc-section-number">0.3</span> geosampling package</a></li>
</ul></li>
<li><a href="introduction.html#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li class="has-sub"><a href="areas.html#areas"><span class="toc-section-number">2</span> Spatial polygon areas</a><ul>
<li><a href="areas.html#cities"><span class="toc-section-number">2.1</span> Cities</a></li>
<li><a href="areas.html#kenyan-tanzania-border"><span class="toc-section-number">2.2</span> Kenyan-Tanzania border</a></li>
<li class="has-sub"><a href="areas.html#malawi-tanzania-zambia-border"><span class="toc-section-number">2.3</span> Malawi-Tanzania-Zambia border</a><ul>
<li><a href="areas.html#malawi"><span class="toc-section-number">2.3.1</span> Malawi</a></li>
<li><a href="areas.html#tanzania-southern-border-area"><span class="toc-section-number">2.3.2</span> Tanzania Southern border area</a></li>
<li><a href="areas.html#zambia"><span class="toc-section-number">2.3.3</span> Zambia</a></li>
</ul></li>
<li><a href="areas.html#summarising-sampling-border-areas"><span class="toc-section-number">2.4</span> Summarising: Sampling border areas</a></li>
</ul></li>
<li><a href="prep.html#prep"><span class="toc-section-number">3</span> Extract Population Data</a></li>
<li class="has-sub"><a href="sampling.html#sampling"><span class="toc-section-number">4</span> Sampling</a><ul>
<li><a href="sampling.html#nairobi-and-lusaka"><span class="toc-section-number">4.1</span> Nairobi and Lusaka</a></li>
</ul></li>
<li class="has-sub"><a href="evaluating-the-sample.html#evaluating-the-sample"><span class="toc-section-number">5</span> Evaluating the Sample</a><ul>
<li class="has-sub"><a href="evaluating-the-sample.html#nairobi"><span class="toc-section-number">5.1</span> Nairobi</a><ul>
<li><a href="evaluating-the-sample.html#identifying-empty-and-underpopulated-units"><span class="toc-section-number">5.1.1</span> Identifying empty and underpopulated units</a></li>
<li><a href="evaluating-the-sample.html#replacement-units"><span class="toc-section-number">5.1.2</span> Replacement units</a></li>
<li><a href="evaluating-the-sample.html#replacement-units-1"><span class="toc-section-number">5.1.3</span> Replacement units</a></li>
</ul></li>
<li class="has-sub"><a href="evaluating-the-sample.html#lusaka"><span class="toc-section-number">5.2</span> Lusaka</a><ul>
<li><a href="evaluating-the-sample.html#replacement-units-2"><span class="toc-section-number">5.2.1</span> Replacement units</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="prep" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Extract Population Data</h1>
<p>To extract the population data, the sampling areas need to unified first. In the next step, the data gets extracted via the <code>prepare_raster_of_sampling_area</code>. Here, we make use of the <code>fasterize</code> package which is much faster in turning <code>SpatialPolygons</code> into raster files than the original <code>rasterize</code> function of the <code>raster</code> package. Finally, we aggregate the extracted data to a 1 and a 5 kilometer grid. The 5 km grid is shown in the following graphs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># unify</span>
<span class="co"># dar_unified &lt;- gUnaryUnion(dar_bins_6)</span>

lusaka_unified &lt;-<span class="st"> </span><span class="kw">gUnaryUnion</span>(lusaka_bins)

nairobi_unified &lt;-<span class="st"> </span><span class="kw">gUnaryUnion</span>(nairobi_bins)

<span class="co"># kenya_unified &lt;- gUnaryUnion(kenya_sampling_bins)</span>

<span class="co"># northern_tanzania_unified &lt;- gUnaryUnion(northern_tanzania_sampling_bins)</span>

<span class="co"># southern_tanzania_unified &lt;- gUnaryUnion(southern_tanzania_sampling_bins)</span>

malawi_unified &lt;-<span class="st"> </span><span class="kw">gUnaryUnion</span>(maw_sampling_bin)

zambia_unified &lt;-<span class="st"> </span><span class="kw">gUnaryUnion</span>(zambia_sampling_bin)

<span class="co"># extract</span>
<span class="co"># dar_population &lt;- </span>
<span class="co">#   prepare_raster_of_sampling_area(tanzania_population,dar_unified)</span>

lusaka_population &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">prepare_raster_of_sampling_area</span>(zambia_population,lusaka_unified)

nairobi_population &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">prepare_raster_of_sampling_area</span>(kenya_population,nairobi_unified)

<span class="co"># kenya_population &lt;- </span>
<span class="co">#   prepare_raster_of_sampling_area(kenya_population,kenya_unified)</span>
<span class="co"># </span>
<span class="co"># northern_tanzania_population &lt;- </span>
<span class="co">#   prepare_raster_of_sampling_area(tanzania_population,</span>
<span class="co">#                                   northern_tanzania_unified)</span>
<span class="co"># </span>
<span class="co"># southern_tanzania_population &lt;- </span>
<span class="co">#   prepare_raster_of_sampling_area(tanzania_population,</span>
<span class="co">#                                   southern_tanzania_unified)</span>

malawi_population &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">prepare_raster_of_sampling_area</span>(malawi_population,malawi_unified)

zambia_population &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">prepare_raster_of_sampling_area</span>(zambia_population,zambia_unified)

<span class="co"># aggregate</span>
<span class="co"># dar_population_1k &lt;- aggregate(dar_population,fact=10,fun=sum,na.rm=TRUE) # 1 km </span>
<span class="co"># dar_population_5k &lt;- aggregate(dar_population,fact=50,fun=sum,na.rm=TRUE) # 5 km</span>

lusaka_population_1k &lt;-<span class="st"> </span><span class="kw">aggregate</span>(luska_population,<span class="dt">fact=</span><span class="dv">10</span>,<span class="dt">fun=</span>sum,<span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co"># 1 km </span>
lusaka_population_5k &lt;-<span class="st"> </span><span class="kw">aggregate</span>(luska_population,<span class="dt">fact=</span><span class="dv">50</span>,<span class="dt">fun=</span>sum,<span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co"># 5 km</span>

nairobi_population_1k &lt;-<span class="st"> </span><span class="kw">aggregate</span>(nairobi_population,<span class="dt">fact=</span><span class="dv">10</span>,<span class="dt">fun=</span>sum,<span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co"># 1 km </span>
nairobi_population_5k &lt;-<span class="st"> </span><span class="kw">aggregate</span>(nairobi_population,<span class="dt">fact=</span><span class="dv">50</span>,<span class="dt">fun=</span>sum,<span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co"># 5 km</span>

<span class="co"># kenya_population_1k &lt;- aggregate(kenya_population,fact=10,fun=sum,na.rm=TRUE) # 1 km </span>
<span class="co"># kenya_population_5k &lt;- aggregate(kenya_population,fact=50,fun=sum,na.rm=TRUE) # 5 km</span>
<span class="co"># </span>
<span class="co"># northern_tanzania_population_1k &lt;- </span>
<span class="co">#   aggregate(northern_tanzania_population,fact=10,fun=sum,na.rm=TRUE) # 1 km </span>
<span class="co"># northern_tanzania_population_5k &lt;- </span>
<span class="co">#   aggregate(northern_tanzania_population,fact=50,fun=sum,na.rm=TRUE) # 5 km</span>
<span class="co"># </span>
<span class="co"># southern_tanzania_population_1k &lt;- </span>
<span class="co">#   aggregate(southern_tanzania_population,fact=10,fun=sum,na.rm=TRUE) # 1 km </span>
<span class="co"># southern_tanzania_population_5k &lt;- </span>
<span class="co">#   aggregate(southern_tanzania_population,fact=50,fun=sum,na.rm=TRUE) # 5 km </span>

malawi_population_1k &lt;-<span class="st"> </span><span class="kw">aggregate</span>(malawi_population,<span class="dt">fact=</span><span class="dv">10</span>,<span class="dt">fun=</span>sum,<span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co"># 1 km </span>
malawi_population_5k &lt;-<span class="st"> </span><span class="kw">aggregate</span>(malawi_population,<span class="dt">fact=</span><span class="dv">50</span>,<span class="dt">fun=</span>sum,<span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co"># 5 km</span>

zambia_population_1k &lt;-<span class="st"> </span><span class="kw">aggregate</span>(zambia_population,<span class="dt">fact=</span><span class="dv">10</span>,<span class="dt">fun=</span>sum,<span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co"># 1 km </span>
zambia_population_5k &lt;-<span class="st"> </span><span class="kw">aggregate</span>(zambia_population,<span class="dt">fact=</span><span class="dv">50</span>,<span class="dt">fun=</span>sum,<span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co"># 5 km</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dar_bins_6 &lt;- add_population(dar_bins_6,dar_population)</span>
lusaka_bins &lt;-<span class="st"> </span><span class="kw">add_population</span>(lusaka_bins,luska_population)
nairobi_bins &lt;-<span class="st"> </span><span class="kw">add_population</span>(nairobi_bins,nairobi_population)

<span class="co"># kenya_bins &lt;- add_population(kenya_sampling_bins,kenya_population)</span>
<span class="co"># northern_tanzania_sampling_bins &lt;- </span>
<span class="co">#   add_population(northern_tanzania_sampling_bins,northern_tanzania_population)</span>
<span class="co"># southern_tanzania_sampling_bins &lt;- </span>
<span class="co">#   add_population(southern_tanzania_sampling_bins,southern_tanzania_population)</span>
maw_sampling_bin &lt;-<span class="st"> </span><span class="kw">add_population</span>(maw_sampling_bin,malawi_population)
zambia_sampling_bin &lt;-<span class="st"> </span><span class="kw">add_population</span>(zambia_sampling_bin,zambia_population)</code></pre></div>
<div class="figure"><span id="fig:cityraster1"></span>
<p class="caption marginnote shownote">
Figure 3.1: Population in a 5 kilometer grid.
</p>
<img src="geosampling_files/figure-html/cityraster1-1.png" alt="Population in a 5 kilometer grid." width="100%"  />
</div>
<div class="figure"><span id="fig:citiesraster2"></span>
<p class="caption marginnote shownote">
Figure 3.2: Population in a 5 kilometer grid.
</p>
<img src="geosampling_files/figure-html/citiesraster2-1.png" alt="Population in a 5 kilometer grid." width="100%"  />
</div>

</div>
<p style="text-align: center;">
<a href="areas.html"><button class="btn btn-default">Previous</button></a>
<a href="sampling.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
